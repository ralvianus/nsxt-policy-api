{
  "resource_type": "Infra",
  "children": [
    {
      "resource_type": "ChildTier1",
      "marked_for_delete": "{{marked_for_delete}}",
      "Tier1": {
        "resource_type": "Tier1",
        "id": "{{Tier1-name}}",
        "description": "{{Tier1-description}}",
        "display_name": "{{Tier1-name}}",
        "failover_mode": "{{Tier1-failover_mode}}",
        "tier0_path":"/infra/tier-0s/Tier-0-GW",
        "route_advertisement_types": [
          "TIER1_LB_SNAT",
          "TIER1_NAT",
          "TIER1_CONNECTED",
          "TIER1_LB_VIP"
        ],
        "children": [
          {
           "resource_type":"ChildLocaleServices",
           "LocaleServices":{
               "resource_type":"LocaleServices",
               "id":  "default",
                "edge_cluster_path": "/infra/sites/default/enforcement-points/default/edge-clusters/{{edge-cluster-id}}"
                }
        },
          {
            "resource_type": "ChildSegment",
            "Segment": {
              "resource_type": "Segment",
              "id": "{{Segment1-id}}",
              "description": "{{Segment1-description}}",
              "display_name": "{{Segment1-id}}",
              "transport_zone_path": "/infra/sites/default/enforcement-points/default/transport-zones/{{Segment-TZid}}",
              "subnets": [
                {
                  "gateway_address": "{{Segment1-gw}}"
                }
              ]
            }
          },
          {
            "resource_type": "ChildSegment",
            "Segment": {
              "resource_type": "Segment",
              "id": "{{Segment2-id}}",
              "description": "{{Segment2-description}}",
              "display_name": "{{Segment2-id}}",
              "transport_zone_path": "/infra/sites/default/enforcement-points/default/transport-zones/{{Segment-TZid}}",
              "subnets": [
                {
                  "gateway_address": "{{Segment2-gw}}"
                }
              ]
            }
          },
          {
            "resource_type": "ChildSegment",
            "Segment": {
              "resource_type": "Segment",
              "id": "{{Segment3-id}}",
              "description": "{{Segment3-description}}",
              "display_name": "{{Segment3-id}}",
              "transport_zone_path": "/infra/sites/default/enforcement-points/default/transport-zones/{{Segment-TZid}}",
              "subnets": [
                {
                  "gateway_address": "{{Segment3-gw}}"
                }
              ]
            }
          },
          {
             "resource_type": "ChildPolicyNat",
             "PolicyNat": {
             "id": "USER",
             "resource_type": "PolicyNat",
             "children": [
                {
                   "resource_type": "ChildPolicyNatRule",
                   "PolicyNatRule": {
                      "resource_type": "PolicyNatRule",
                      "id": "{{NAT-Rule-id}}",
                      "action": "SNAT",
                      "source_network": "{{NAT-Source}}",
                      "service": "",
                      "translated_network": "{{NAT-IP}}",
                      "scope": [],
                      "enabled": true,
                      "firewall_match": "BYPASS",
                      "display_name": "{{NAT-Rule-id}}",
                      "parent_path": "/infra/tier-1s/{{Tier1-name}}/nat/USER"
                   }
                }
             ]
           }
        }
       ]
      }
    },
    {
      "resource_type": "ChildDomain",
      "marked_for_delete": "false",
      "Domain": {
        "id": "default",
        "resource_type": "Domain",
        "description": "default",
        "display_name": "default",
        "marked_for_delete": "false",
        "children": [
          {
            "resource_type": "ChildGroup",
            "Group": {
              "resource_type": "Group",
              "marked_for_delete": "{{marked_for_delete}}",
              "description": "{{secgroup1-id}}",
              "display_name": "{{secgroup1-id}}",
              "id": "{{secgroup1-id}}",
              "expression": [
                {
                  "member_type": "VirtualMachine",
                  "value": "{{scope}}|{{sectag1}}",
                  "key": "Tag",
                  "operator": "EQUALS",
                  "resource_type": "Condition"
                }
              ]
            }
          },
          {
            "resource_type": "ChildGroup",
            "Group": {
              "resource_type": "Group",
              "marked_for_delete": "{{marked_for_delete}}",
              "description": "{{secgroup2-id}}",
              "display_name": "{{secgroup2-id}}",
              "id": "{{secgroup2-id}}",
              "expression": [
                {
                  "member_type": "VirtualMachine",
                  "value": "{{scope}}|{{sectag2}}",
                  "key": "Tag",
                  "operator": "EQUALS",
                  "resource_type": "Condition"
                }
              ]
            }
          },
          {
            "resource_type": "ChildGroup",
            "Group": {
              "resource_type": "Group",
              "marked_for_delete": "{{marked_for_delete}}",
              "description": "{{secgroup3-id}}",
              "display_name": "{{secgroup3-id}}",
              "id": "{{secgroup3-id}}",
              "expression": [
                {
                  "member_type": "VirtualMachine",
                  "value": "{{scope}}|{{sectag3}}",
                  "key": "Tag",
                  "operator": "EQUALS",
                  "resource_type": "Condition"
                }
              ]
            }
          },
          {
            "resource_type": "ChildGroup",
            "Group": {
              "resource_type": "Group",
              "marked_for_delete": "{{marked_for_delete}}",
              "description": "{{secgroupblanket-id}}",
              "display_name": "{{secgroupblanket-id}}",
              "id": "{{secgroupblanket-id}}",
              "expression": [
                {
                  "member_type": "VirtualMachine",
                  "value": "{{scope}}|{{sectagblanket}}",
                  "key": "Tag",
                  "operator": "EQUALS",
                  "resource_type": "Condition"
                }
              ]
            }
          },
          {
            "resource_type": "ChildSecurityPolicy",
            "marked_for_delete": "{{marked_for_delete}}",
            "SecurityPolicy": {
              "id": "{{EW-securitypolicy-section-id}}",
              "resource_type": "SecurityPolicy",
              "description": "communication map",
              "display_name": "{{EW-securitypolicy-section-id}}",
              "rules": [
                {
                  "resource_type": "Rule",
                  "description": "Communication Entry",
                  "display_name": "{{Rule1-id}}",
                  "sequence_number": 1,
                  "logged": true,
                  "source_groups": [
                    "ANY"
                  ],
                  "destination_groups": [
                    "/infra/domains/default/groups/{{secgroup1-id}}"
                  ],
                  "services": [
                    "/infra/services/HTTP"
                  ],
                  "scope": [
                    "/infra/domains/default/groups/{{secgroupblanket-id}}"
                  ],
                  "action": "ALLOW"
                },
                {
                  "resource_type": "Rule",
                  "description": "Communication Entry 2",
                  "display_name": "{{Rule2-id}}",
                  "sequence_number": 2,
                  "logged": true,
                  "source_groups": [
                    "/infra/domains/default/groups/{{secgroup1-id}}"
                  ],
                  "destination_groups": [
                    "/infra/domains/default/groups/{{secgroup2-id}}"
                  ],
                  "services": [
                    "/infra/services/HTTP"
                  ],
                  "scope": [
                    "/infra/domains/default/groups/{{secgroupblanket-id}}"
                  ],
                  "action": "ALLOW"
                },
                {
                  "resource_type": "Rule",
                  "description": "Communication Entry 3",
                  "display_name": "{{Rule3-id}}",
                  "sequence_number": 3,
                  "logged": true,
                  "source_groups": [
                    "/infra/domains/default/groups/{{secgroup2-id}}"
                  ],
                  "destination_groups": [
                    "/infra/domains/default/groups/{{secgroup3-id}}"
                  ],
                  "services": [
                    "/infra/services/MySQL"
                  ],
                  "scope": [
                    "/infra/domains/default/groups/{{secgroupblanket-id}}"
                  ],
                  "action": "ALLOW"
                }
              ]
            }
          },
          {
            "resource_type": "ChildGatewayPolicy",
            "marked_for_delete": "{{marked_for_delete}}",
            "GatewayPolicy": {
              "resource_type": "GatewayPolicy",
              "id": "{{NS-securitypolicy-section-id}}",
              "display_name": "{{NS-securitypolicy-section-id}}",
              "parent_path": "/infra/domains/default",
              "marked_for_delete": "{{marked_for_delete}}",
              "rules": [
                {
                 "source_groups": [
                        "ANY"
                    ],
                    "destination_groups": [
                        "/infra/domains/default/groups/{{secgroup1-id}}"
                    ],
                    "services": [
                        "/infra/services/HTTP"
                    ],
                    "profiles": [
                        "ANY"
                    ],
                    "action": "ALLOW",
                    "logged": true,
                    "scope": [
                        "/infra/tier-1s/{{Tier1-name}}"
                    ],
                    "disabled": false,
                    "notes": "",
                    "direction": "IN_OUT",
                    "tag": "",
                    "ip_protocol": "IPV4_IPV6",
                    "resource_type": "Rule",
                    "id": "Any-to-web",
                    "display_name": "Any-to-web"
                },
                {
                 "source_groups": [
                        "ANY"
                    ],
                    "destination_groups": [
                        "/infra/domains/default/groups/{{secgroup1-id}}",
                        "/infra/domains/default/groups/{{secgroup2-id}}",
                        "/infra/domains/default/groups/{{secgroup3-id}}"
                    ],
                    "services": [
                        "ANY"
                    ],
                    "profiles": [
                        "ANY"
                    ],
                    "action": "DROP",
                    "logged": false,
                    "scope": [
                        "/infra/tier-1s/{{Tier1-name}}"
                    ],
                    "disabled": false,
                    "notes": "",
                    "direction": "IN_OUT",
                    "tag": "",
                    "ip_protocol": "IPV4_IPV6",
                    "resource_type": "Rule",
                    "id": "DenyAny",
                    "display_name": "DenyAny"
                }
               ]
            }
          }
       ]
    }
   },
    {
      "resource_type": "ChildLBClientSslProfile",
      "LBClientSslProfile": {
        "resource_type": "LBClientSslProfile",
        "id": "batchSetupClientSslProfile",
        "cipher_group_label": "CUSTOM",
        "session_cache_enabled": true,
        "ciphers": [
          "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
          "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
        ],
        "protocols": [
          "TLS_V1_2"
        ]
      }
    },
    {
      "resource_type": "ChildLBServerSslProfile",
      "LBServerSslProfile": {
        "resource_type": "LBServerSslProfile",
        "id": "batchSetupServerSslProfile",
        "cipher_group_label": "CUSTOM",
        "session_cache_enabled": true,
        "ciphers": [
          "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
          "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
        ],
        "protocols": [
          "TLS_V1_2"
        ]
      }
    },
    {
      "resource_type": "ChildLBAppProfile",
      "LBAppProfile": {
        "resource_type": "LBHttpProfile",
        "id": "batchSetupHttpAppProfile",
        "x_forwarded_for": "INSERT"
      }
    },
    {
      "resource_type": "ChildLBMonitorProfile",
      "LBMonitorProfile": {
        "resource_type": "LBHttpMonitorProfile",
        "id": "batchSetupHttpMonitor1",
        "monitor_port": 80,
        "timeout": 5,
        "response_status_codes": [
          200,
          300
        ]
      }
    },
    {
      "resource_type": "ChildLBMonitorProfile",
      "LBMonitorProfile": {
        "resource_type": "LBHttpsMonitorProfile",
        "id": "batchSetupHttpsMonitor1",
        "monitor_port": 443,
        "timeout": 5,
        "response_status_codes": [
          200
        ]
      }
    },
    {
      "resource_type": "ChildLBService",
      "LBService": {
        "resource_type": "LBService",
        "id": "{{lb-id}}",
        "marked_for_delete": "{{marked_for_delete}}",
        "connectivity_path": "/infra/tier-1s/{{Tier1-name}}",
        "error_log_level": "DEBUG",
        "access_log_enabled": true
      }
    },
    {
      "resource_type": "ChildLBVirtualServer",
      "LBVirtualServer": {
        "resource_type": "LBVirtualServer",
        "id": "{{vs-id}}",
        "marked_for_delete": "{{marked_for_delete}}",
        "lb_service_path": "/infra/lb-services/{{lb-id}}",
        "ip_address": "{{vs-ip}}",
        "ports": [
          "80"
        ],
        "pool_path": "/infra/lb-pools/{{pool-id}}",
        "application_profile_path": "/infra/lb-app-profiles/batchSetupHttpAppProfile"
        }
      },
    {
      "resource_type": "ChildLBPool",
      "LBPool":
      {
        "id": "{{pool-id}}",
        "marked_for_delete": "{{marked_for_delete}}",
        "resource_type": "LBPool",
        "active_monitor_paths": [
          "/infra/lb-monitor-profiles/batchSetupHttpMonitor1"
        ],
            "algorithm": "ROUND_ROBIN",
            "member_group": {
                "group_path": "/infra/domains/default/groups/{{secgroup1-id}}",
                "ip_revision_filter": "IPV4"
            },
            "snat_translation": {
                "type": "LBSnatDisabled"
            }
      }
    }
  ]
}
